import{_ as de}from"./B2oi46Uj.js";import{c as ce}from"./CWG2-AVp.js";import{t as te}from"./DzRIXkPM.js";import fe from"./w3htNUYG.js";import{s as N,e as se,$ as ve,k as R,j as q,o as B,w as P,b as $,i as x,a0 as G,a7 as W,q as oe,S as pe,x as me,m as he,n as ge,v as ye,a1 as be,c as O,a as j,F as le,r as xe,p as V,a2 as Ce,h as ae,t as ke}from"./BiiBGYRd.js";import{r as Te,u as ne,c as Ke,b as Se}from"./Bn2h5X3h.js";import{g as U,_ as Ie,M as Ae,u as Ee,a as we}from"./X369pMiD.js";import{u as _e}from"./Cc81KTfG.js";import{i as re}from"./wSbNHcIL.js";import{P as ue}from"./DkPbciIt.js";import"./4d5pypES.js";import"./DpAkTBdT.js";import"./NmKlcnzH.js";import"./ClGykRXb.js";function ie(r,a,e){const c=e.originalEvent.target,T=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:e});a&&c.addEventListener(r,a,{once:!0}),c.dispatchEvent(T)}function Ve(r){const a=Te("",1e3);return{search:a,handleTypeaheadSearch:(T,l)=>{a.value=a.value+T;{const f=U(),v=l.map(y=>{var A,L;return{...y,textValue:((A=y.value)==null?void 0:A.textValue)??((L=y.ref.textContent)==null?void 0:L.trim())??""}}),s=v.find(y=>y.ref===f),g=v.map(y=>y.textValue),E=Re(g,a.value,s==null?void 0:s.textValue),C=v.find(y=>y.textValue===E);return C&&C.ref.focus(),C==null?void 0:C.ref}},resetTypeahead:()=>{a.value=""}}}function Be(r,a){return r.map((e,c)=>r[(a+c)%r.length])}function Re(r,a,e){const T=a.length>1&&Array.from(a).every(g=>g===a[0])?a[0]:a,l=e?r.indexOf(e):-1;let f=Be(r,Math.max(l,0));T.length===1&&(f=f.filter(g=>g!==e));const s=f.find(g=>g.toLowerCase().startsWith(T.toLowerCase()));return s!==e?s:void 0}function Y(r,a,e){const c=r.findIndex(v=>re(v,a)),T=r.findIndex(v=>re(v,e));if(c===-1||T===-1)return[];const[l,f]=[c,T].sort((v,s)=>v-s);return r.slice(l,f+1)}function H(r){return r.reduce((a,e)=>(a.push(e),e.children&&a.push(...H(e.children)),a),[])}function Le(r,a){const e=N(),c=(l,f)=>{if(a.multiple&&Array.isArray(r.value))if(a.selectionBehavior==="replace")r.value=[l],e.value=l;else{const v=r.value.findIndex(s=>f(s));v!==-1?r.value=r.value.filter((s,g)=>g!==v):r.value=[...r.value,l]}else a.selectionBehavior==="replace"?r.value={...l}:!Array.isArray(r.value)&&f(r.value)?r.value=void 0:r.value={...l};return r.value};function T(l,f,v,s){var y;if(!(e!=null&&e.value)||!a.multiple||!Array.isArray(r.value))return;const E=(y=v().filter(A=>A.ref.dataset.disabled!=="").find(A=>A.ref===f))==null?void 0:y.value;if(!E)return;let C=null;switch(l){case"prev":case"next":{C=Y(s,e.value,E);break}case"first":{C=Y(s,e.value,s==null?void 0:s[0]);break}case"last":{C=Y(s,e.value,s==null?void 0:s[s.length-1]);break}}r.value=C}return{firstValue:e,onSelectItem:c,handleMultipleReplace:T}}const[$e,Me]=Ke("TreeRoot"),Pe=se({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:r=>r.children},selectionBehavior:{default:"toggle"},multiple:{},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},bubbleSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(r,{emit:a}){const e=r,c=a,{items:T,multiple:l,disabled:f,propagateSelect:v,dir:s,bubbleSelect:g}=ve(e),{handleTypeaheadSearch:E}=Ve(),C=_e(s),y=N(),A=N(!1),L=Se(),n=ne(e,"modelValue",c,{defaultValue:e.defaultValue??(l.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),o=ne(e,"expanded",c,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:t,handleMultipleReplace:i}=Le(n,e),u=R(()=>l.value&&Array.isArray(n.value)?n.value.map(d=>e.getKey(d)):[e.getKey(n.value??{})]);function p(d,h=1,b){return d.reduce((I,k,_)=>{const M=e.getKey(k),D=e.getChildren(k),z=o.value.includes(M),F={_id:M,value:k,index:_,level:h,parentItem:b,hasChildren:!!D,bind:{value:k,level:h,"aria-setsize":d.length,"aria-posinset":_+1}};return I.push(F),D&&z&&I.push(...p(D,h+1,k)),I},[])}const m=R(()=>{const d=e.items;return o.value.map(h=>h),p(d??[])});function S(d){var h;if(A.value)L.trigger(d);else{const b=((h=y.value)==null?void 0:h.getItems())??[];E(d.key,b)}}function K(d){if(A.value)return;const h=Ae[d.key];pe(()=>{var b;i(h,U(),(b=y.value)==null?void 0:b.getItems,m.value.map(I=>I.value))})}function w(d){var h;if(d.parentItem!=null&&Array.isArray(n.value)&&e.multiple){const b=m.value.find(I=>d.parentItem!=null&&e.getKey(I.value)===e.getKey(d.parentItem));b!=null&&(((h=e.getChildren(b.value))==null?void 0:h.every(k=>n.value.find(_=>e.getKey(_)===e.getKey(k))))?n.value=[...n.value,b.value]:n.value=n.value.filter(k=>e.getKey(k)!==e.getKey(b.value)),w(b))}}return Me({modelValue:n,selectedKeys:u,onSelect:d=>{var I;const h=k=>e.getKey(k??{})===e.getKey(d),b=e.multiple&&Array.isArray(n.value)?((I=n.value)==null?void 0:I.findIndex(h))!==-1:void 0;if(t(d,h),e.bubbleSelect&&e.multiple&&Array.isArray(n.value)){const k=m.value.find(_=>e.getKey(_.value)===e.getKey(d));k!=null&&w(k)}if(e.propagateSelect&&e.multiple&&Array.isArray(n.value)){const k=H(e.getChildren(d)??[]);b?n.value=[...n.value].filter(_=>!k.some(M=>e.getKey(_??{})===e.getKey(M))):n.value=[...n.value,...k]}},expanded:o,onToggle(d){if(!(d?e.getChildren(d):void 0))return;const b=e.getKey(d)??d;o.value.includes(b)?o.value=o.value.filter(I=>I!==b):o.value.push(b)},getKey:e.getKey,getChildren:e.getChildren,items:T,expandedItems:m,disabled:f,multiple:l,dir:C,propagateSelect:v,bubbleSelect:g,isVirtual:A,virtualKeydownHook:L,handleMultipleReplace:i}),(d,h)=>(B(),q(x(Ie),{ref_key:"rovingFocusGroupRef",ref:y,"as-child":"",orientation:"vertical",dir:x(C)},{default:P(()=>[$(x(ue),{role:"tree",as:d.as,"as-child":d.asChild,"aria-multiselectable":x(l)?!0:void 0,onKeydown:[S,G(W(K,["shift"]),["up","down"])]},{default:P(()=>[oe(d.$slots,"default",{flattenItems:m.value,modelValue:x(n),expanded:x(o)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),De="tree.select",Ne="tree.toggle",Oe=se({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(r,{expose:a,emit:e}){const c=r,T=e,l=$e(),{getItems:f}=Ee(),v=R(()=>!!l.getChildren(c.value)),s=R(()=>{const t=l.getKey(c.value);return l.expanded.value.includes(t)}),g=R(()=>{const t=l.getKey(c.value);return l.selectedKeys.value.includes(t)}),E=R(()=>{if(l.bubbleSelect.value&&v.value&&Array.isArray(l.modelValue.value)){const t=H(l.getChildren(c.value)||[]);return t.some(i=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(i)))&&!t.every(i=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(i)))}else return l.propagateSelect.value&&g.value&&v.value&&Array.isArray(l.modelValue.value)?!H(l.getChildren(c.value)||[]).every(i=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(i))):void 0});function C(t){if(v.value)if(s.value){const i=f().map(K=>K.ref),u=U(),p=i.indexOf(u),S=[...i].slice(p).find(K=>Number(K.getAttribute("data-indent"))===c.level+1);S&&S.focus()}else o(t)}function y(t){if(s.value)o(t);else{const i=f().map(K=>K.ref),u=U(),p=i.indexOf(u),S=[...i].slice(0,p).reverse().find(K=>Number(K.getAttribute("data-indent"))===c.level-1);S&&S.focus()}}async function A(t){T("select",t),!(t!=null&&t.defaultPrevented)&&l.onSelect(c.value)}async function L(t){T("toggle",t),!(t!=null&&t.defaultPrevented)&&l.onToggle(c.value)}async function n(t){if(!t)return;const i={originalEvent:t,value:c.value,isExpanded:s.value,isSelected:g.value};ie(De,A,i)}async function o(t){if(!t)return;const i={originalEvent:t,value:c.value,isExpanded:s.value,isSelected:g.value};ie(Ne,L,i)}return a({isExpanded:s,isSelected:g,isIndeterminate:E,handleToggle:()=>l.onToggle(c.value),handleSelect:()=>l.onSelect(c.value)}),(t,i)=>(B(),q(x(we),{"as-child":"",value:t.value,"allow-shift-key":""},{default:P(()=>[$(x(ue),me(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":g.value,"aria-expanded":v.value?s.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":g.value?"":void 0,"data-expanded":s.value?"":void 0,onKeydown:[G(W(n,["self","prevent"]),["enter","space"]),i[0]||(i[0]=G(W(u=>x(l).dir.value==="ltr"?C(u):y(u),["prevent"]),["right"])),i[1]||(i[1]=G(W(u=>x(l).dir.value==="ltr"?y(u):C(u),["prevent"]),["left"]))],onClick:i[2]||(i[2]=W(u=>{n(u),o(u)},["stop"]))}),{default:P(()=>[oe(t.$slots,"default",{isExpanded:s.value,isSelected:g.value,isIndeterminate:E.value,handleSelect:()=>x(l).onSelect(t.value),handleToggle:()=>x(l).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),We={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-highlighted before:bg-elevated"},false:{link:["hover:text-highlighted hover:before:bg-elevated/50","transition-colors before:transition-colors"]}}}},lt={__name:"CodeTree",props:{defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(r){const a=r,e=he(),c=ge(),[T,l]=ce(),f=R(()=>{var n,o;return te({extend:te(We),...((o=(n=c.uiPro)==null?void 0:n.prose)==null?void 0:o.codeTree)||{}})()}),v=N(a.defaultValue?{path:a.defaultValue}:void 0),s=N(),g=N(1),E=R(()=>{var n,o;return g.value,((o=(n=e.default)==null?void 0:n.call(e))==null?void 0:o.flatMap(A).filter(Boolean))||[]}),C=R(()=>y(E.value));function y(n){const o=new Map,t=[];n.forEach(u=>{const p=u.label.split("/");let m="";p.forEach((S,K)=>{var w,d;if(m=m?`${m}/${S}`:S,!o.has(m)){const h={label:S,path:m,...K<p.length-1&&{children:[]}};o.set(m,h),K===0?t.push(h):(d=(w=o.get(p.slice(0,K).join("/")))==null?void 0:w.children)==null||d.push(h)}})});const i=u=>u.sort((p,m)=>!!p.children==!!m.children?p.label.localeCompare(m.label):m.children?1:-1).map(p=>({...p,children:p.children&&i(p.children)}));return i(t)}function A(n,o){var t,i,u,p;return typeof n.type=="symbol"?(t=n.children)==null?void 0:t.map(A):{label:((i=n.props)==null?void 0:i.filename)||((u=n.props)==null?void 0:u.label)||`${o}`,icon:(p=n.props)==null?void 0:p.icon,component:n}}const L=R(()=>{var t;if(a.expandAll){const i=new Set;return E.value.forEach(u=>{const p=u.label.split("/");for(let m=1;m<p.length;m++)i.add(p.slice(0,m).join("/"))}),Array.from(i)}const n=(t=v.value)==null?void 0:t.path;if(!n)return[];const o=n.split("/");return o.map((i,u)=>o.slice(0,u+1).join("/"))});return ye(v,n=>{const o=E.value.find(t=>(n==null?void 0:n.path)===t.label);o!=null&&o.component&&(s.value=o)},{immediate:!0}),be(()=>g.value++),(n,o)=>{var i,u,p,m;const t=de;return B(),O(le,null,[$(x(T),null,{default:P(({items:S,level:K})=>[(B(!0),O(le,null,xe(S,(w,d)=>{var h,b;return B(),O("li",{key:`${K}-${d}`,class:V(K>0?f.value.itemWithChildren({class:(h=a.ui)==null?void 0:h.itemWithChildren}):f.value.item({class:(b=a.ui)==null?void 0:b.item}))},[$(x(Oe),{"as-child":"",level:K,value:w},{default:P(({isExpanded:I,isSelected:k})=>{var _,M,D,z,F,J,Q,X,Z,ee;return[j("button",{class:V(f.value.link({class:(_=a.ui)==null?void 0:_.link,active:k}))},[(M=w.children)!=null&&M.length?(B(),q(t,{key:0,name:I?x(c).ui.icons.folderOpen:x(c).ui.icons.folder,class:V(f.value.linkLeadingIcon({class:(D=a.ui)==null?void 0:D.linkLeadingIcon}))},null,8,["name","class"])):(B(),q(fe,{key:1,filename:w.label,class:V(f.value.linkLeadingIcon({class:(z=a.ui)==null?void 0:z.linkLeadingIcon}))},null,8,["filename","class"])),j("span",{class:V(f.value.linkLabel({class:(F=a.ui)==null?void 0:F.linkLabel}))},ke(w.label),3),(J=w.children)!=null&&J.length?(B(),O("span",{key:2,class:V(f.value.linkTrailing({class:(Q=a.ui)==null?void 0:Q.linkTrailing}))},[$(t,{name:x(c).ui.icons.chevronDown,class:V(f.value.linkTrailingIcon({class:(X=a.ui)==null?void 0:X.linkTrailingIcon}))},null,8,["name","class"])],2)):ae("",!0)],2),(Z=w.children)!=null&&Z.length&&I?(B(),O("ul",{key:0,class:V(f.value.listWithChildren({class:(ee=a.ui)==null?void 0:ee.listWithChildren}))},[$(x(l),{items:w.children,level:K+1},null,8,["items","level"])],2)):ae("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),j("div",{class:V(f.value.root({class:[(i=a.ui)==null?void 0:i.root,a.class]}))},[$(x(Pe),{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=S=>v.value=S),class:V(f.value.list({class:(u=a.ui)==null?void 0:u.list})),items:C.value,"get-key":S=>S.path,"default-expanded":L.value},{default:P(()=>[$(x(l),{items:C.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),j("div",{class:V(f.value.content({class:(p=a.ui)==null?void 0:p.content}))},[(B(),q(Ce((m=s.value)==null?void 0:m.component)))],2)],2)],64)}}};export{lt as default};
